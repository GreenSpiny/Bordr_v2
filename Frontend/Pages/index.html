<html>
  <head>

    <!-- Ensure the frame spans the whole page -->
    <style>
      iframe {
        border: 0px;
        width: 100%;
        height: 100%;
      }
    </style>

    <!-- JQuery, Angular, Bootstrap, Socket.IO -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

    <!-- Custom JS Scripts -->
    <script src="scripts/autofill.js"></script>
    <script src="scripts/query.js"></script>
    <script>

      var pages = {}

      function Initialize(callback) {
        pages = {
          "nav": null,
          "menu": null,
          "event_listing": null,
          "create_event": null,
          "my_events": null,
          "friends": null,
          "profile": null
        };

        js = [
          "menu",
          "event_listing",
          "create_event",
          "my_events",
          "friends",
          "profile"
        ]

        var requests = [];
        for (key in pages) {
          // Create a closure to hold the loop value
          (function(key) {
            requests.push (
              $.get(key + '.html', function(page) {
                pages[key] = page;
              })
            );
          })(key);
        }

        js.forEach (function (script) {
          // Create a closure to hold the loop value
          (function(script) {
            requests.push (
              $.getScript('scripts/' + script + '.js')
            );
          })(script);
        });

        $.when.apply($, requests).then( function() {
          callback();
        });

      }

      function LoadPage(page) {
        var html = page + '.html';
        $("body").html("");

        if (page != "menu")
          $("body").append(pages["nav"]);

        $("body").append(pages[page]);

        if (page != "menu")
          window['JS_' + page].Initialize();


        $(".redirect").each( function () {
          $( this ).on("click", function( event ) {
            $("body").fadeOut(300, function () {
              LoadPage( $( event.target ).data('redirect') );
              autofill.Initialize();
              $("body").fadeIn(300);
            });
          });
        });
      }

      Initialize( function() { LoadPage("menu"); });

    </script>

  </head>
  <body>

  </body>
</html>